webpackJsonp([1],{"2mTW":function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=n("d6ZO"),s=n.n(i),c=n("lVil"),l=n("wygQ"),u=n("IaRT"),p=n.n(u),d=n("xYG1"),m=s.a.createElement(c.a,null),f=function(e){function t(){return a(this,t),r(this,e.apply(this,arguments))}return o(t,e),t.prototype.shouldComponentUpdate=function e(t,n){return this.props.currentPanel!==t.currentPanel||this.props.conversationsUnseenCount!==t.conversationsUnseenCount||this.props.newsHubCount!==t.newsHubCount},t.prototype.render=function e(){var t=this.props,n=t.conversationsUnseenCount,a=t.currentPanel,r=t.handleItemClick,o=t.locale,i=t.newsHubCount,c=t.onButtonClick,u=t.siteType,p=void 0;return a===d.a.NEWS_HUB?p=s.a.createElement(l.a,{handleItemClick:r,locale:o,siteType:u}):a===d.a.INBOX&&(p=m),s.a.createElement("div",{className:"NewsConversationsDropdown"},s.a.createElement(d.b,{conversationsUnseenCount:n,newsHubCount:i,onButtonClick:c,selectedTab:a}),s.a.createElement("div",{className:"content"},p))},t}(i.Component);t.default=f},"7Dxt":function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=Object(f.a)(e),n=function(e){function n(){var t,o,i;a(this,n);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return t=o=r(this,e.call.apply(e,[this].concat(c))),o.state={impressionStarted:!1,impressionLogged:!1},o.currentNs=function(){return Date.now()*b},o.startTime=0,o.debugPinImpressions=g&&"Pin"===o.props.impressionType&&o.props.viewer.isEmployee,o.handleVisibilityChanged=function(e){var t=o.props,n=t.componentType,a=t.contextLog,r=t.contextLogData,i=t.impressionAuxFields,s=t.impressionType,c=t.loggingId,l=t.slotIndex,u=t.viewParameter,p=t.viewType,d=t.viewData;if(e<=0){var m,f,h=y[s],v=h.idType,g=o.currentNs(),b=Object.assign((m={endTime:g},m[v]=c,m.slotIndex=l,m.time=o.startTime,m.renderDuration=g-o.startTime,m),i);a(h.eventType,Object.assign({component:n,eventData:(f={},f[h.impressionType]=[b],f),view:p,viewParameter:u,viewData:d},r)),o.debugPinImpressions&&(console.log(l+" logged for "+(g-o.startTime)/1e9+"s"),o.setState({impressionStarted:!1,impressionLogged:!0}))}else o.startTime=o.currentNs(),o.debugPinImpressions&&(console.log(l+" started timer"),o.setState({impressionStarted:!0}))},i=t,r(o,i)}return o(n,e),n.prototype.render=function e(){return s.createElement(t,Object.assign({onVisibilityChanged:this.handleVisibilityChanged,debugImpressionStarted:this.debugPinImpressions?this.state.impressionStarted:void 0,debugImpressionLogged:this.debugPinImpressions?this.state.impressionLogged:void 0},this.props))},n}(s.Component);return Object(h.compose)(d.a,m.a)(n)}t.a=i;var s=n("d6ZO"),c=n.n(s),l=n("IaRT"),u=n.n(l),p=n("FJZF"),d=n("Kqaz"),m=n("i0Ug"),f=n("sHx0"),h=n("MQ2h"),v=n.n(h),g=p.a.getQueryStringParams()&&p.a.getQueryStringParams().debug_impression_log,y={Article:{impressionType:"articleImpressions",idType:"articleIdStr",eventType:3829},Pin:{impressionType:"pinImpressions",idType:"pinIdStr",eventType:18},Board:{impressionType:"boardImpressions",idType:"boardIdStr",eventType:3700},Interest:{impressionType:"topicImpressions",idType:"topicIdStr",eventType:3703},Search:{impressionType:"searchImpressions",idType:"term",eventType:3803},User:{impressionType:"userImpressions",idType:"userIdStr",eventType:3704},News:{impressionType:"newsHubData",idType:"newsIdStr",eventType:4110}},b=1e6},RvAN:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n("d6ZO"),s=n.n(i),c=n("GGB8"),l=n.n(c),u=n("W/Cr"),p=n("IaRT"),d=n.n(p),m=n("WBZ1"),f=n.n(m),h=n("gEaE"),v=n("7IpV"),g={UP:"up",DOWN:"down"},y=100,b=function(e){function t(){var n,o,i;a(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return n=o=r(this,e.call.apply(e,[this].concat(c))),o.handleScroll=f()(function(){if(!o.props.isFetching){var e=o.props.scrollThreshold;Object(v.b)(o._container)-Object(v.c)(o._container)-Object(v.a)(o._container)<e&&o.fetchMore()}},y),o.addEventListeners=function(e){var t=o.props.useWindow;t&&(e=window),o.removeEventListeners(),e&&(t||e.addEventListener("wheel",o.preventScroll),e.addEventListener("scroll",o.handleScroll)),o._container=e},o.preventScroll=function(e){var t=e.deltaY<0?g.UP:g.DOWN,n=o._container.scrollHeight-o._container.scrollTop-o._container.clientHeight==0,a=0===o._container.scrollTop;(t===g.DOWN&&n||t===g.UP&&a)&&e.preventDefault()},i=n,r(o,i)}return o(t,e),t.prototype.componentWillReceiveProps=function e(t){var n=t.data,a=t.onDataFetched;n&&a(n.length)},t.prototype.componentWillUnmount=function e(){this.removeEventListeners()},t.prototype.removeEventListeners=function e(){var t=this.props.useWindow;this._container&&(t||this._container.removeEventListener("wheel",this.preventScroll),this._container.removeEventListener("scroll",this.handleScroll))},t.prototype.fetchMore=function e(){this.props.isFetching||(this.props.isAtEnd?this._container.removeEventListener("scroll",this.handleScroll):this.props.fetchMoreData())},t.prototype.render=function e(){var t=this.props,n=t.className,a=t.data,r=t.isFetching,o=t.renderEmptyState,i=t.renderItem;return!r&&a&&0===a.length?o():s.a.createElement("div",{className:l()(n,"listContainer"),ref:this.addEventListeners},this.props.data?s.a.createElement("ul",{className:"scrollableList"},this.props.data.map(function(e,t){return i(e,t)})):null,this.props.isAtEnd?null:s.a.createElement("div",{className:"loadingItem"},s.a.createElement(h.E,{accessibilityLabel:u.a._("Loading items"),show:this.props.isFetching})))},t}(i.Component);b.defaultProps={data:[],onDataFetched:function e(){},scrollThreshold:400,useWindow:!1},t.a=b},U7FU:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=e.viewer;return{viewerId:t.isAuth?t.id:null}}var s=n("d6ZO"),c=n.n(s),l=n("DUIN"),u=n("GGB8"),p=n.n(u),d=n("IaRT"),m=n.n(d),f=n("gEaE"),h=3,v=[["fullWrapper"],["leftWrapper halfWrapper","rightWrapper halfWrapper isWholeHalf"],["leftWrapper halfWrapper","rightWrapper halfWrapper smallImage top","rightWrapper halfWrapper smallImage bottom"]],g=function e(t,n){var a=t.name,r=t.image_thumbnail_url;return c.a.createElement("div",{className:p()("Image","Module","boardMessageRep",n)},c.a.createElement("img",{alt:a,src:r}))},y=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments[2],r=arguments[3],o={small:"sm",medium:"md",normal:"lg"};return c.a.createElement(f.b,{display:"flex",alignItems:"center"},c.a.createElement(f.l,{collaborators:a.map(function(e,t){return{name:e.full_name||e.email||e.username||"user "+t,src:e.is_default_image?void 0:e.image_large_url||e.image_medium_url}}),size:o[t]}))},b=function(e){function t(){return a(this,t),r(this,e.apply(this,arguments))}return o(t,e),t.prototype.getUsersToShow=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=this.props.viewerId;return void 0!==a&&(n=n.filter(function(e){return e.id!==a})),n.concat(t.map(function(e){return{full_name:e,first_name:e}})).slice(0,3)},t.prototype.render=function e(){var t=this.props,n=t.board,a=t.emails,r=t.shouldLink,o=t.size,i=t.users,s=this.getUsersToShow(a,i),c=s.length<=3?v[s.length-1]:[];return n?g(n,o):s.length>0?y(o,c,s,r):null},t}(s.Component);b.defaultProps={shouldLink:!1,size:"medium"},t.a=Object(l.connect)(i)(b)},lVil:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=e.contactCount,n=e.isInContactRequestsView,a=e.onClick;if(!t&&!n)return null;var r=void 0;return r=t>G?R.a._("1000+ contact requests","messaging"):t>=F&&t<=G?R.a._("100+ contact requests","messaging"):j.h(R.a.ngettext("{{ contactCount }} contact request","{{ contactCount }} contact requests",t),{contactCount:""+t}),S.a.createElement(M.b,{dangerouslySetInlineStyle:{__style:{paddingLeft:10,paddingRight:10}},paddingY:1},S.a.createElement("div",{className:"Module ContactRequestsCount"},S.a.createElement(H.a,{className:z()({contactRequestView:n},"isBrioFlat","contactRequestsCount","btn"),hasIcon:n,hasText:!0,onClick:a,text:r,type:"borderless"})))}function s(e){var t=e.contactRequests,n=e.handleCancelViewContactRequests;return t?S.a.createElement("div",{className:"Module ContactRequestsCount"},S.a.createElement(Y,{contactCount:t.length,isInContactRequestsView:!0,onClick:n}),S.a.createElement(M.b,{padding:2},S.a.createElement(M.I,{size:"sm"},R.a._("These messages appear from people outside of your networks.","contact requests disclaimer"))),t.map(function(e,t){return S.a.createElement("div",{key:e.id},0!==t?Z:null,S.a.createElement(U,e))})):null}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function p(e){var t=e.name,n=e.emails,a=e.users,r=e.viewerId,o=a.filter(function(e){return e.id!==r});return S.a.createElement(M.I,{color:"darkGray",size:"xs",bold:!0,truncate:!0},t||o.map(function(e){return e.first_name||e.full_name}).concat(n).join(", "))}function d(e){var t=e.board,n=e.created_at,a=e.pin,r=e.sender,o=e.text,i=e.user,s=o;if(!s){var c=r.first_name;a?s=j.h(R.a._("{{ senderName }} sent a Pin","messaging"),{senderName:c}):t?s=j.h(R.a._("{{ senderName }} sent a board","messaging"),{senderName:c}):i&&(s=j.h(R.a._("{{ senderName }} sent a user profile","messaging"),{senderName:c}))}return S.a.createElement(M.b,{display:"flex",direction:"column",flex:"grow"},S.a.createElement(M.b,{flex:"grow"},S.a.createElement(M.I,{color:"gray",size:"xs",truncate:!0},Object(ae.b)(s||"",oe))),S.a.createElement(M.I,{color:"gray",size:"xs"},R.a.getHumanizedTimesince(n)))}function m(e){var t=e.board,n=e.pin,a=e.user;if(n){var r=n.images["236x"]||n.images["136x136"];return S.a.createElement(M.t,{shape:"rounded",wash:!0,height:50,width:30},S.a.createElement(M.p,{alt:"",src:r.url,naturalWidth:r.width,naturalHeight:r.height,color:n.dominant_color,fit:"cover"}))}return t?S.a.createElement(M.t,{shape:"rounded",width:30,height:30},S.a.createElement(M.p,{alt:"",src:t.image_thumbnail_url||"",naturalWidth:60,naturalHeight:60})):a?S.a.createElement(M.b,{width:30,height:30},S.a.createElement(M.a,{name:a.full_name,src:a.image_large_url})):null}function f(e){return{viewerId:e.viewer.id}}function h(e){var t=e.contactItem,n=e.currentUserID,a=e.conversationItem,r=e.handleContactWrapperClick,o=e.isSelected,i=e.isUser,s=["selectionIndicator","contactCircleRep","selectionIndicator"];return S.a.createElement("a",{className:"conversationContactContainer",key:a.id,onClick:function e(){return r(i,t)},onKeyDown:function e(){},role:"button",tabIndex:0},le(n,a),o?S.a.createElement("div",{className:s.join(" ")},ue):null)}function v(e){var t=e.onClickRemove,n=e.tokenizedItems;return x.createElement("div",{className:"reactTokenizedInputContainer",style:{zIndex:1e3}},x.createElement("div",{className:"tokenContainer"},n.map(function(e,n){return x.createElement("div",{className:"tokenItem",key:n,style:{position:"relative"}},x.createElement(H.a,{className:"tokenRemove",onClick:function e(){return t(n)},showText:!1,text:R.a._("close conversation chathead"),type:"borderless"},x.createElement(M.b,{position:"absolute",color:"lightGray",display:"flex",alignItems:"center",justifyContent:"center",width:12,height:12,dangerouslySetInlineStyle:{__style:{borderRadius:6}}},de)),"string"!=typeof e?x.createElement(M.a,{size:"sm",name:e.full_name,src:e.is_default_image?void 0:e.image_large_url}):x.createElement(M.a,{size:"sm",name:e}))}),n.length>0?me:null),fe)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _(e){var t=e.boardInvites;return t?S.a.createElement("div",null,t.map(function(e){return S.a.createElement(Ee,{boardInviteItem:e,key:e.id})})):null}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function N(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function O(e){return e.sort(function(e,t){return new Date((t.last_message||t).created_at)-new Date((e.last_message||e).created_at)}),e}var x=n("d6ZO"),S=n.n(x),k=n("DUIN"),j=n("5tOk"),R=n("W/Cr"),P=n("ZtCB"),D=n.n(P),L=n("fvzG"),M=n("gEaE"),B=function(e){function t(){var n,o,i;a(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return n=o=r(this,e.call.apply(e,[this].concat(c))),o.state={contactRequestCompleted:!1,isAcceptButtonLoading:!1,isIgnoreButtonLoading:!1},o.handleInviteAcceptResponse=function(){o.setState({isAcceptButtonLoading:!0,isIgnoreButtonLoading:!1}),D.a.create("ContactRequestAcceptResource",{contact_request:o.props}).callUpdate().then(function(e){var t=o.props.dispatch;if(o.setState({contactRequestCompleted:!0,isAcceptButtonLoading:!1}),e&&e.resource_response.data){var n=e.resource_response.data;t(Object(L.c)(n)),t(Object(L.h)(n.id)),t(Object(L.g)(n.id))}})},o.handleInviteDeclineResponse=function(){o.setState({isAcceptButtonLoading:!1,isIgnoreButtonLoading:!0}),D.a.create("ContactRequestIgnoreResource",{contact_request:o.props}).callDelete().then(function(){o.setState({contactRequestCompleted:!0,isIgnoreButtonLoading:!1})})},i=n,r(o,i)}return o(t,e),t.prototype.renderRequestText=function e(t,n,a){if(t){var r=t.name,o=t.url;if(r&&o)return j.h(R.a._('<a href="/{{ senderUsername }}/">{{ senderName }}</a> invited you to collaborate on <a href="{{ boardUrl }}">{{ boardName }}</a>'),{boardName:r.toString(),boardUrl:o.toString(),senderName:n,senderUsername:a})}return j.h(R.a._('<a href="/{{ senderUsername }}/">{{ senderName }}</a> wants to send a message to you'),{senderName:n,senderUsername:a})},t.prototype.render=function e(){var t=this.state,n=t.contactRequestCompleted,a=t.isAcceptButtonLoading,r=t.isIgnoreButtonLoading;if(n)return null;var o=this.props,i=o.board,s=o.sender,c=s.image_large_url,l=s.full_name,u=s.username;return S.a.createElement(M.b,{paddingX:2,paddingY:4,display:"flex"},S.a.createElement(M.b,{height:50,width:50,flex:"none"},S.a.createElement(M.s,{href:"/"+u+"/"},S.a.createElement(M.a,{name:u,src:c}))),S.a.createElement(M.b,{paddingX:3,flex:"grow"},S.a.createElement(M.b,{marginBottom:3},S.a.createElement(M.I,null,S.a.createElement("span",{dangerouslySetInnerHTML:{__html:this.renderRequestText(i,l,u)}}))),S.a.createElement(M.b,{display:"flex",marginLeft:-1,marginRight:-1},S.a.createElement(M.b,{paddingX:1,flex:"grow"},S.a.createElement(M.c,{disabled:r,onClick:this.handleInviteDeclineResponse,size:"sm",text:R.a._("Decline","ignore contact request")})),S.a.createElement(M.b,{paddingX:1,flex:"grow"},S.a.createElement(M.c,{color:"red",disabled:a,onClick:this.handleInviteAcceptResponse,size:"sm",text:R.a._("Accept","accept contact request")})))))},t}(x.PureComponent),U=Object(k.connect)()(B),W=n("IaRT"),A=n.n(W),q=n("GGB8"),z=n.n(q),H=n("nM9s"),V=n("JKYN"),F=100,G=1e3,Y=Object(V.b)({name:"ContactRequestsCountGetResource",key:"contactCount"},{allowStale:!1})(i),Z=S.a.createElement(M.i,null),K=Object(V.b)({name:"ContactRequestsResource",key:"contactRequests"},{allowStale:!1})(s),Q=n("U7FU"),X=n("dnEF"),J=n("tmfO"),$=n("Kqaz"),ee=n("/S3G"),te=n("MQ2h"),ne=n.n(te),ae=n("Vfgg"),re=n("dCTv"),oe=50,ie=S.a.createElement("span",{className:"conversationUnreadMark"}),se=function(e){function t(){var n,a,r;c(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=l(this,e.call.apply(e,[this].concat(i))),a.state={isAnimatingOut:!1,unread:a.props.data.unread||0},a.handleHideConversation=function(e){e.stopPropagation();var t=a.props,n=t.data,r=t.dispatch,o=n.id;D.a.create("ConversationResource",{conversation_id:o}).callDelete({showError:!1}),a.setState({isAnimatingOut:!0}),setTimeout(function(){r(Object(L.d)(o))},500),a.removeConversationChatHead(o),a.logConversationItemHide(o)},a.handleConversationItemClick=function(){var e=a.props.data;a.setState({unread:0}),e.board||a.showConversationChatHead(e),a.logConversationItemClick()},a.logConversationItemClick=function(){(0,a.props.contextLog)(101,{component:54,element:277})},a.logConversationItemHide=function(e){(0,a.props.contextLog)(182,{component:54,element:277,conversation_id:e})},r=n,l(a,r)}return u(t,e),t.prototype.showConversationChatHead=function e(t){var n=this.props.dispatch,a=t.id;n(Object(L.h)(a)),n(Object(L.g)(a)),n(ee.a)},t.prototype.removeConversationChatHead=function e(t){var n=this.props.dispatch;n(Object(L.e)(t)),n(Object(L.b)(t))},t.prototype.renderItemContent=function e(){var t=this.state.isAnimatingOut,n=this.props,a=n.data,r=n.viewerId,o=n.experiments,i=a.board,s=a.emails,c=a.last_message,l=a.name,u=a.users,f=s||[];return S.a.createElement("div",{className:z()("ConversationListItemReact",{conversationHidden:t})},S.a.createElement(M.b,{display:"flex",alignItems:"center",dangerouslySetInlineStyle:{__style:{marginRight:10}}},S.a.createElement(Q.a,{board:i,emails:f,users:u})),S.a.createElement(M.b,{display:"flex",width:"100%",height:"100%"},S.a.createElement(M.b,{flex:"grow",display:"flex",direction:"column",height:"100%"},S.a.createElement(p,{name:l,emails:s||[],users:u,viewerId:r}),S.a.createElement(M.b,{flex:"grow",display:"flex",direction:"column",marginTop:1},c?S.a.createElement(d,c):null)),c&&(o.activate("web_conversation_thumbnail")||"").includes("enabled")?S.a.createElement(M.b,{display:"flex",alignItems:"center",width:30,marginLeft:2,marginRight:5},S.a.createElement(M.b,{display:"block"},S.a.createElement(m,c))):null),this.state.unread>0?ie:null,S.a.createElement(H.a,{className:"conversationCloseButton",hasText:!0,onClick:this.handleHideConversation,text:R.a._("×","close button"),type:"borderless"}))},t.prototype.render=function e(){var t=this.props.data,n=t.board,a=t.users;return a&&a.length?n?S.a.createElement(J.b,{onClick:this.handleConversationItemClick,to:n.url},this.renderItemContent()):S.a.createElement("div",{onClick:this.handleConversationItemClick,role:"button"},this.renderItemContent()):null},t}(x.Component),ce=Object(te.compose)(Object(k.connect)(f),$.a,re.b)(se),le=function e(t,n){var a=n.emails,r=n.users,o=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t&&0!==t.length){var n=t[0];return S.a.createElement("div",{className:"contactWrapper"},S.a.createElement(Q.a,{emails:[n],size:"small"}),S.a.createElement("div",{className:"contactTextInfo"},S.a.createElement("span",{className:"contactName"},n),S.a.createElement("span",{className:"contactDescription"},R.a._("Email friend","on selected contact list"))))}},i=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=n[0].id===t?n[1]:n[0],r=a.full_name;return S.a.createElement("div",{className:"contactWrapper"},S.a.createElement(Q.a,{size:"small",users:[a]}),S.a.createElement("div",{className:"contactTextInfo"},S.a.createElement("span",{className:"contactName"},r),S.a.createElement("span",{className:"contactDescription"},R.a._("On Pinterest","info about a contact"))))};return S.a.createElement("div",null,a&&a.length>0?o(a):i(r))},ue=S.a.createElement("em",null);h.defaultProps={isSelected:!1};var pe=n("tZWC"),de=x.createElement(M.n,{icon:"cancel",accessibilityLabel:"",size:5,color:"darkGray"}),me=x.createElement(M.b,{width:5}),fe=x.createElement("div",{className:"textFieldContainer"}),he=8,ve=2,ge=function(e){function t(){var n,a,r;g(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=y(this,e.call.apply(e,[this].concat(i))),a.state={contactCounter:0,selectedEmails:{},selectedUsers:{},tokenizedItems:[],value:""},a.onHandleContactClick=function(e,t){var n=a.state,r=n.selectedEmails,o=n.selectedUsers,i=e?o:r,s=e?t.id:t,c=i[s];i[s]=!c,c?a.removeTokenItem(t):a.addTokenItem(t)},a.getSelectedEmails=function(){var e=a.state.selectedEmails;return Object.keys(e).filter(function(t){return e[t]})},a.getSelectedUsers=function(){var e=a.state.selectedUsers;return Object.keys(e).filter(function(t){return e[t]})},a.handleTypeaheadKeyDown=function(e){var t=a.state,n=t.contactCounter,r=t.selectedEmails,o=t.selectedUsers,i=t.tokenizedItems,s=t.value;if(e.keyCode===he&&n&&!s){var c=i.pop(),l=!!c.id,u=c.id||c;(l?o:r)[u]=!1,a.setState({contactCounter:n-1,tokenizedItems:i})}},a.handleInviteItemClick=function(e,t){var n=a.state,r=n.selectedUsers,o=n.selectedEmails,i=e?r:o,s=t.id||t;i[s]||(i[s]=!0,a.addTokenItem(t))},a.handleRemoveItem=function(e){var t=a.state.tokenizedItems[e];a.removeTokenItem(t)},a.handleSendMessage=function(){var e=a.getSelectedEmails(),t=a.getSelectedUsers(),n=a.props.dispatch;D.a.create("ConversationsResource",{user_ids:t,emails:e,text:null}).callCreate().then(function(e){var t=e&&e.resource_response.data;n(Object(L.c)(t)),n(Object(L.h)(t.id)),n(Object(L.g)(t.id))})},a.addTokenItem=function(e){var t=a.state,n=t.contactCounter,r=t.tokenizedItems;a.setState({contactCounter:n+1,tokenizedItems:r.concat([e]),value:""})},a.removeTokenItem=function(e){var t=a.state,n=t.contactCounter,r=t.tokenizedItems,o=t.selectedUsers,i=t.selectedEmails,s=!!e.id,c=e.id||e;(s?o:i)[c]=!1,e.id?a.setState({contactCounter:n-1,tokenizedItems:r.filter(function(t){return t.id!==e.id})}):a.setState({contactCounter:n-1,tokenizedItems:(r||[]).filter(function(t){return t!==e})})},a.renderSendMessageButton=function(){return S.a.createElement(H.a,{className:"sendNewMessageButton",hasText:!0,onClick:a.handleSendMessage,showText:!0,text:R.a._("Next","open the new chat"),type:"borderless"})},a.renderCancelMessageButton=function(){var e=a.props.handleCancelNewMessageClick;return S.a.createElement(H.a,{className:"cancelNewMessageView cancelButton",hasText:!0,onClick:e,showText:!0,text:R.a._("Cancel","cancel new message view"),type:"borderless"})},r=n,y(a,r)}return b(t,e),t.prototype.getContactItem=function e(t,n,a){var r=t.emails,o=t.users;return a&&o?o[0].id===n?o[1]:o[0]:r[0]},t.prototype.render=function e(){var t=this,n=this.props,a=n.conversationItems,r=n.viewerId,o=this.state,i=o.contactCounter,s=o.selectedUsers,c=o.selectedEmails,l=o.value,u=new Set,p=a.map(function(e,n){var a=e.emails,o=e.users;a||(a=[]),o||(o=[]);var i=o.length+a.length;if(i>0&&i<=2){var l=0===a.length,p=t.getContactItem(e,r,l);if(p){var d=p.id||p;if(!u.has(d))return u.add(d),S.a.createElement(h,{className:"conversationContactContainer",contactItem:p,conversationItem:e,currentUserID:r,handleContactWrapperClick:t.onHandleContactClick,isSelected:s[d]||c[d],isUser:l,key:d+"-"+n})}}return null});return S.a.createElement("div",null,S.a.createElement(M.b,{display:"flex",justifyContent:"between",padding:3},S.a.createElement(M.I,{size:"sm",color:"gray"},R.a._("New message","conversations")),i>0?this.renderSendMessageButton():this.renderCancelMessageButton()),S.a.createElement(M.b,{color:"lightGray",display:"flex",padding:3},S.a.createElement(M.b,{display:"flex",alignItems:"center",marginRight:2},S.a.createElement(M.I,{size:"sm"},R.a._("To:","new message"))),S.a.createElement(M.b,{display:"flex",position:"relative",flex:"grow"},S.a.createElement(v,{tokenizedItems:this.state.tokenizedItems,onClickRemove:this.handleRemoveItem}),S.a.createElement(pe.a,{changeOnTextHover:!1,className:"reactNewMessageTypeahead",onChange:function e(n){return t.setState({value:n})},onInviteItemClick:this.handleInviteItemClick,onKeyDown:this.handleTypeaheadKeyDown,showInputPlaceholder:!1,value:this.state.value}))),l?null:S.a.createElement("div",{className:"contactsContainer"},p))},t}(x.Component),ye=function e(t){return{viewerId:t.viewer.id}},be=Object(te.compose)(Object(k.connect)(ye))(ge),Ee=function(e){function t(){var n,a,r;E(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=w(this,e.call.apply(e,[this].concat(i))),a.state={boardInviteAccepted:!1,boardInvitePending:!0,isAcceptButtonLoading:!1,isIgnoreButtonLoading:!1},a.handleInviteResponse=function(e){var t=a.props.boardInviteItem,n=t.board,r=void 0===n?{}:n,o=t.invited_user,i=void 0===o?{}:o;a.setState({isAcceptButtonLoading:e,isIgnoreButtonLoading:!e});var s={board_id:r.id,invited_user_id:i.id},c=D.a.create("BoardInviteResource",s);(e?c.callUpdate():c.callDelete()).then(function(){a.setState({boardInviteAccepted:e,boardInvitePending:!1,isAcceptButtonLoading:!1,isIgnoreButtonLoading:!1})})},r=n,w(a,r)}return C(t,e),t.prototype.getBoardRep=function e(t,n){return S.a.createElement("div",{className:"leftObjectWrapper boardRepWrapper"},S.a.createElement("div",{className:"Image Module boardMessageRep"},S.a.createElement("div",{className:"heightContainer"},S.a.createElement("img",{alt:t,src:n}))))},t.prototype.getBoardInfo=function e(t,n){return S.a.createElement("a",{href:n},S.a.createElement("div",{className:t},t))},t.prototype.getInviteeInfo=function e(t){var n=t.full_name;return S.a.createElement("div",{className:"inviterLine"},Object(j.h)(R.a._("{{ fullName }} invited you to this board"),{fullName:n}))},t.prototype.renderPendingLayout=function e(t,n){var a=this,r=t.image_thumbnail_url,o=t.name,i=t.url;return S.a.createElement("div",{className:"pending"},S.a.createElement("div",{className:"left"},this.getBoardRep(o,r),S.a.createElement("div",{className:"description"},this.getBoardInfo(o,i),this.getInviteeInfo(n))),S.a.createElement("div",{className:"actions"},S.a.createElement(H.a,{className:"remove",loading:this.state.isIgnoreButtonLoading,onClick:function e(){return a.handleInviteResponse(!1)},text:R.a._("Decline","ignore board invite")}),S.a.createElement(H.a,{className:z()("primary","accept"),loading:this.state.isAcceptButtonLoading,onClick:function e(){return a.handleInviteResponse(!0)},text:R.a._("Accept","accept board invite")})))},t.prototype.renderCompletedLayout=function e(t){var n=t.image_thumbnail_url,a=t.name,r=t.url;return S.a.createElement("div",{className:"success displayed"},S.a.createElement("div",{className:"left"},this.getBoardRep(a,n),S.a.createElement("div",{className:"description"},this.getBoardInfo(a,r),S.a.createElement("div",{className:"inviterLine"},R.a._("You joined this board","board invites")))))},t.prototype.render=function e(){if(!this.state.boardInvitePending&&!this.state.boardInviteAccepted)return null;var t=this.props.boardInviteItem,n=t.board,a=t.invited_by_user;return S.a.createElement("div",{className:"BoardInvite Module news"},this.state.boardInvitePending?this.renderPendingLayout(n,a):this.renderCompletedLayout(n))},t}(x.Component),we=Object(V.b)({name:"BoardInvitesResource",key:"boardInvites",options:{current_user:!0,field_set_key:"news"}},{allowStale:!1})(_),Ce=n("nX0T"),_e=500,Ie="existingConversationsView",Te="newMessageView",Ne="contactRequestsView",Oe=S.a.createElement("div",{className:"icon"}),xe=S.a.createElement("div",{className:"boardInvitesContainer"},S.a.createElement(we,null)),Se=function(e){function t(){var n,a,r;I(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=a=T(this,e.call.apply(e,[this].concat(i))),a.state={currentView:Ie},a.handleCancelSecondaryView=function(){a.setState({currentView:Ie})},a.handleNewMessageButtonClick=function(){a.setState({currentView:Te}),a.logNewMessageButtonClick()},a.handleViewContactRequestsClick=function(){a.setState({currentView:Ne})},a.handleScroll=function(){a.props.isFetching||(a._container&&a._container.scrollHeight-a._container.scrollTop-a._container.clientHeight)<_e&&a.fetchMore()},a.logNewMessageButtonClick=function(){(0,a.props.contextLog)(101,{component:54,element:275})},r=n,T(a,r)}return N(t,e),t.prototype.componentDidMount=function e(){var t=this.props,n=t.isFullAuth,a=t.contextLog;n&&this._container.addEventListener("scroll",this.handleScroll),a(7161,{})},t.prototype.componentWillUnmount=function e(){this._container.removeEventListener("scroll",this.handleScroll)},t.prototype.fetchMore=function e(){var t=this.props,n=t.isAtEnd,a=t.isFetching,r=t.fetchMoreData,o=t.isFullAuth;!a&&o&&(n?this._container.removeEventListener("scroll",this.handleScroll):r())},t.prototype.renderNewMessageView=function e(){var t=this.props.conversations,n=void 0===t?[]:t;return S.a.createElement("div",{className:"newMessageContainer"},S.a.createElement(be,{conversationItems:n,handleCancelNewMessageClick:this.handleCancelSecondaryView}))},t.prototype.renderContactRequestsView=function e(){return S.a.createElement("div",{className:"contactRequestsContainer"},S.a.createElement(K,{handleCancelViewContactRequests:this.handleCancelSecondaryView}))},t.prototype.renderEmptyMessagesNewMessageUpsell=function e(){return S.a.createElement("div",{className:"EmptyConversations Module"},Oe,S.a.createElement("div",{className:"intro"},S.a.createElement("div",null,R.a._("Send messages to your friends!")),S.a.createElement("div",null,R.a._("Plan projects, swap ideas and share your best discoveries."))))},t.prototype.renderExistingConversationsView=function e(){var t=this.props,n=t.conversations,a=void 0===n?[]:n,r=t.isAtEnd;return S.a.createElement("div",{className:"existingConversationsContainer"},S.a.createElement("div",{className:"newMessageButtonContainer"},S.a.createElement(M.b,{dangerouslySetInlineStyle:{__style:{paddingLeft:10,paddingRight:10}}},S.a.createElement(H.a,{className:"createConversationTab",hasIcon:!0,onClick:this.handleNewMessageButtonClick,text:R.a._("New message"),type:"borderless"}))),S.a.createElement("div",{className:"viewContactRequestsButtonContainer"},S.a.createElement(Y,{onClick:this.handleViewContactRequestsClick})),S.a.createElement("div",{className:"existingConversationItemsWrapper"},xe,S.a.createElement("ul",{className:"conversationItems"},0===a.length&&r?this.renderEmptyMessagesNewMessageUpsell():a.map(function(e){return S.a.createElement("li",{className:"conversationItemWrapper",key:e.id},S.a.createElement(ce,{data:e}))}))))},t.prototype.renderMessageView=function e(){switch(this.state.currentView){case Ie:return this.renderExistingConversationsView();case Te:return this.renderNewMessageView();case Ne:return this.renderContactRequestsView()}},t.prototype.render=function e(){var t=this;return S.a.createElement(Ce.a,{view:42,viewParameter:203},S.a.createElement("div",{className:"conversationPanel",ref:function e(n){t._container=n}},this.renderMessageView()))},t}(x.Component),ke=function e(t){return Object.keys(t).map(function(e){return t[e]})},je=function e(t){var n=t.conversations,a=t.viewer;return{conversations:O(ke(n.data)),isFullAuth:a.isAuth&&!a.isLimitedLogin}},Re=t.a=Object(te.compose)(Object(k.connect)(je),$.a,Object(V.b)({name:"ConversationsResource",key:"conversationsResource"},{allowStale:!1}))(Se)},wygQ:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=n("d6ZO"),u=n.n(l),p=n("SnoN"),d=n("GGB8"),m=n.n(d),f=n("IaRT"),h=n.n(f),v={ONE:1,TWO:2,END:3},g=function(e){function t(){var n,o,i;a(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return n=o=r(this,e.call.apply(e,[this].concat(c))),o.state={educationStep:v.ONE},o.toStepTwo=function(){o.setState({educationStep:v.TWO})},o.dismissEducation=function(){var e=o.props.handleDismiss;o.setState({educationStep:v.END}),e()},i=n,r(o,i)}return o(t,e),t.prototype.componentDidMount=function e(){var t=this,n=this.props.stepDelay;this.educationStepTimer=setTimeout(function(){t.state.educationStep<v.TWO&&t.setState({educationStep:v.TWO})},n)},t.prototype.componentWillUnmount=function e(){clearTimeout(this.educationStepTimer)},t.prototype.renderPill=function e(t,n,a){return u.a.createElement("button",{onClick:a,className:m()("educationPill","slideIn",{fadeOut:n})},u.a.createElement("div",{className:"message"},t))},t.prototype.render=function e(){var t=this.state.educationStep,n=this.props,a=n.titleText,r=n.titleText2,o=this.renderPill(a,t===v.TWO,this.toStepTwo),i=this.renderPill(r,t===v.END,this.dismissEducation);return u.a.createElement("div",{className:"newsHubEducation"},u.a.createElement("div",{className:"educationStep stepOne"},(t===v.ONE||t===v.TWO)&&o),u.a.createElement("div",{className:"educationStep stepTwo bottom"},(t===v.TWO||t===v.END)&&i))},t}(l.Component),y=n("W/Cr"),b=n("zFaW"),E=n("7Dxt"),w=Object(E.a)(b.a),C=n("mnfW"),_=n("RvAN"),I=n("nX0T"),T=n("Kqaz"),N=n("mHth"),O=n("YZkw"),x=n("MQ2h"),S=n.n(x),k=n("JKYN"),j=n("gEaE"),R=4,P=864e5,D=Object(k.b)({name:"NewsHubResource",options:{page_size:10}},{allowStale:!1})(_.a),L=function(e){function t(n){i(this,t);var a=s(this,e.call(this,n));return a.state={shouldEducate:!1},a.onDataFetched=function(e){a.props.experience&&e>R&&!a.state.shouldEducate&&a.setState({shouldEducate:!0})},a.handleItemClick=function(){a.handleComplete(),a.props.handleItemClick()},a.handleComplete=function(){var e=a.props,t=e.experienceClient,n=e.experience;n&&t.completeExperience(n.placement_id,n.experience_id)},a.handleDismiss=function(){var e=a.props,t=e.experienceClient,n=e.experience;n&&t.dismissExperience(n.placement_id,n.experience_id)},a.renderItem=function(e,t){var n={impressionAuxFields:{displayMode:e.encoded_display_mode,newsType:e.news_type},impressionType:"News",loggingId:e.id,slotIndex:t,viewParameter:3081,viewType:107};return u.a.createElement("li",{className:"newsHubItemWrapper",key:t},a.renderDate(e.last_updated_at,t),u.a.createElement(w,Object.assign({contentItemCount:e.content_item_count,contentItems:e.content_items,contentText:e.content_text,displayMode:e.encoded_display_mode,handleClick:a.handleItemClick,headerIconImageUrl:e.header_icon_image_url,headerIconObjects:e.header_icon_objects,headerText:e.header_text,id:e.id,lastUpdatedAt:e.last_updated_at,overrideClickUrl:e.override_click_url,subHeaderText:e.sub_header_text,siteType:a.props.siteType,textMapping:e.text_mapping,type:e.news_type,unread:e.unread},n)))},a.renderEmptyState=function(){return u.a.createElement(j.b,{height:400},u.a.createElement(j.b,{display:"flex",justifyContent:"center",color:"darkGray",shape:"pill",paddingY:5,margin:5},u.a.createElement(j.g,{xs:10},u.a.createElement(j.I,{bold:!0,color:"white",size:"lg"},y.a._("New! Discover ideas from your friends, followers and people who love your Pins!")))))},a.currentDay=null,a.today=new Date,a.today.setHours(0,0,0,0),a}return c(t,e),t.prototype.getChildContext=function e(){return{preloadingSupported:!0}},t.prototype.componentDidMount=function e(){var t=this.props,n=t.experience,a=t.experienceClient;n&&a.viewExperience(n.placement_id,n.experience_id),this.logPanelImpression()},t.prototype.shouldComponentUpdate=function e(t,n){if(this.state.shouldEducate===n.shouldEducate){var a=this.props.experience,r=t.experience;return(a||{}).id!==(r||{}).id}return!0},t.prototype.getEducation=function e(){var t=this.props.experience;if(this.state.shouldEducate&&t){var n=t.display_data,a=n.step_delay,r=n.title_text,o=n.title_text_2;return u.a.createElement(g,{handleDismiss:this.handleDismiss,stepDelay:a,titleText:r,titleText2:o})}return null},t.prototype.logPanelImpression=function e(){var t=this.props.contextLog,n=p.a.getInstance(),a=n.getViewFromContext();t(13,{view:107,viewParameter:3081}),n.addViewToContext(a)},t.prototype.renderDate=function e(t,n){var a=new Date(t);if(a.setHours(0,0,0,0),0!==n&&null!==this.currentDay&&void 0!==this.currentDay){var r=this.currentDay;if(a.getTime()===r.getTime())return null}this.currentDay=a;var o=void 0;return o=a.getTime()===this.today.getTime()?y.a._("Today"):a.getTime()===new Date(this.today-864e5).getTime()?y.a._("Yesterday"):a&&a>=new Date(this.today-5184e5)?y.a.getHumanizedTimesince(a.toString()):C.b.formatDate(this.props.locale,a,C.b.DateFormatType.MONTH_DAY,!1),u.a.createElement("div",{className:"newsHubItemDate"},u.a.createElement(j.I,{bold:!0,size:"xl"},o))},t.prototype.render=function e(){return u.a.createElement(I.a,{view:107,viewParameter:3081},u.a.createElement("div",null,this.getEducation(),u.a.createElement(D,{className:"newsHubPanel",onDataFetched:this.onDataFetched,renderEmptyState:this.renderEmptyState,renderItem:this.renderItem})))},t}(l.Component);L.defaultProps={handleItemClick:function e(){}},L.childContextTypes={preloadingSupported:h.a.bool.isRequired};var M=t.a=Object(x.compose)(Object(O.a)(1000035),T.a,N.a)(L)}});